(this["webpackJsonpchat-client"]=this["webpackJsonpchat-client"]||[]).push([[0],{118:function(e,t,n){e.exports=n(166)},123:function(e,t,n){},159:function(e,t){},162:function(e,t,n){},165:function(e,t,n){e.exports=n.p+"static/media/stairs.ac905963.mp3"},166:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n.n(r),s=n(14),c=n.n(s),o=(n(123),n(46)),i=n(199),u=n(196),l=n(198),d=n(56),p=n(200),m=n(194),E=n(25),f=Object(m.a)((function(e){return{root:{flexGrow:1},title:{flexGrow:1}}}));var g=Object(E.b)((function(e){return{loggedIn:e.auth.loggedIn,user:e.auth.user}}),(function(e){return{logOut:function(){return e({type:"USER_LOGOUT"})}}}))((function(e){var t=e.loggedIn,n=e.logOut,r=e.user,s=f();return a.a.createElement(u.a,{position:"static"},a.a.createElement(l.a,null,a.a.createElement(d.a,{variant:"h6",className:s.title},"Chat"),t?a.a.createElement(i.a,{container:!0,justify:"flex-end",alignItems:"center",spacing:2},a.a.createElement(i.a,{item:!0},a.a.createElement(d.a,{variant:"subtitle1",className:s.title},"id: ".concat(r.id))),a.a.createElement(i.a,{item:!0},a.a.createElement(d.a,{variant:"h6",className:s.title},r.username)),a.a.createElement(i.a,{item:!0},a.a.createElement(p.a,{color:"inherit",onClick:n},"Logout"))):a.a.createElement(p.a,{color:"inherit"},a.a.createElement(o.b,{to:"/login",style:{textDecoration:"none",color:"white"}},"Login"))))})),b=n(10),h=n.n(b),y=n(7),O=n(27),v=n(30),j=n(202),S=n(203),x=n(211),I=n(209),_=Object(m.a)({fullWidth:{width:"100%"}});function w(e){var t=e.label,n=e.value,r=e.type,s=e.errorMessage,c=e.onChange,o=_();return a.a.createElement(I.a,{variant:"outlined",type:r,className:o.fullWidth,label:t,value:n,helperText:s,error:!!s&&0!==s.length,onChange:c})}var R=n(17),T=Object(m.a)({center:{textAlign:"center"},mgTop:{marginTop:"15px"},fullWidth:{width:"100%"}});var N=Object(E.b)((function(e){return{inputFields:e.auth.inputFields,errorMessages:e.auth.errorMessages}}),(function(e){return{userLogin:function(t){return e({type:"USER_LOGIN",payload:t})},setInputFields:function(t){return e({type:"SET_INPUT_FIELDS",payload:t})},resetIE:function(){return e({type:"RESET_IE"})}}}))((function(e){var t=e.userLogin,n=e.errorMessages,s=e.inputFields,c=e.setInputFields,o=e.resetIE,u=T(),l=Object(R.f)();Object(r.useEffect)((function(){var e=l.listen((function(e,t){o()}));return function(){e()}}),[l,o]);var m=Object(r.useState)(!0),E=Object(v.a)(m,2),f=E[0],g=E[1],b=function(){var e=Object(O.a)(h.a.mark((function e(n){return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t(Object(y.a)(Object(y.a)({},s),{},{keep:f,history:l}));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return a.a.createElement(i.a,{item:!0,container:!0,spacing:2,direction:"column",className:u.mgTop,xs:10,md:6},a.a.createElement(d.a,{className:u.center,variant:"h2"},"Login"),a.a.createElement(i.a,{item:!0},a.a.createElement(w,{label:"User Name",type:"text",value:s.username,onChange:function(e){c(Object(y.a)(Object(y.a)({},s),{},{username:e.target.value}))},errorMessage:n.username})),a.a.createElement(i.a,{item:!0},a.a.createElement(w,{label:"Password",type:"Password",value:s.password,onChange:function(e){c(Object(y.a)(Object(y.a)({},s),{},{password:e.target.value}))},errorMessage:n.password})),a.a.createElement(j.a,{error:!0},n.other),a.a.createElement(i.a,{item:!0},a.a.createElement(S.a,{control:a.a.createElement(x.a,{checked:f,onChange:function(){return g(!f)},name:"checkedB",color:"primary"}),label:"Keep Me Logged In"})),a.a.createElement(i.a,{item:!0},a.a.createElement(p.a,{className:u.fullWidth,size:"large",variant:"contained",color:"primary",onClick:b},"Login")),a.a.createElement(p.a,{onClick:function(){return l.push("/register")}}," Register "))}));var L=function(){return Object(r.useEffect)((function(){document.title="Login"}),[]),a.a.createElement(i.a,{container:!0,direction:"row",justify:"center"},a.a.createElement(g,null),a.a.createElement(i.a,{item:!0,xs:1,md:3}),a.a.createElement(N,null),a.a.createElement(i.a,{item:!0,xs:1,md:3}))},C=n(210),F=n(201),D=n(204),k=n(205),A=n(213),U=n(206),M=n(207);var G=function(e){var t=e.friends,n=e.setRead,s=e.selectedIndex,c=e.setSelectedIndex,o=e.showFriends,u=e.setShowFriends,l=e.addFriend,p=e.friendError;Object(r.useLayoutEffect)((function(){function e(){if(S.current){S.current.style.setProperty("height","".concat(document.getElementById("root").clientHeight-210,"px"))}window.innerWidth>=600?g("block"):g(o?"block":"none")}return window.addEventListener("resize",e),e(),function(){return window.removeEventListener("resize",e)}}),[o]),Object(r.useEffect)((function(){t.length>0&&t[s].unRead&&n(t,s)}),[s,t,n]);var m=Object(r.useState)("block"),E=Object(v.a)(m,2),f=E[0],g=E[1];Object(r.useEffect)((function(){window.innerWidth<600&&g(o?"block":"none")}),[o]);var b=Object(r.useState)(""),h=Object(v.a)(b,2),y=h[0],O=h[1],S=Object(r.useRef)();return a.a.createElement(C.a,{component:i.a,item:!0,xs:12,sm:4,lg:3,xl:2,style:{display:f}},a.a.createElement(d.a,{variant:"h4"},"Friends"),a.a.createElement(F.a,{ref:S,id:"friends",style:{overflowY:"scroll"}},t.map((function(e,t){return a.a.createElement(D.a,{key:t,button:!0,selected:s===t,onClick:function(){return function(e){c(e),o&&u(!1)}(t)}},a.a.createElement(k.a,null,a.a.createElement(A.a,{alt:e.username,src:"/static/images/avatar/".concat(t+1,".jpg")})),a.a.createElement(U.a,{primary:e.username}),e.unRead?a.a.createElement(M.a,{color:"secondary",variant:"dot"}):null)}))),a.a.createElement(I.a,{variant:"outlined",label:"Add Friend",style:{width:"95%",marginTop:"10px",marginLeft:"5px",marginRight:"5px"},value:y,onChange:function(e){return O(e.target.value)},onKeyPress:function(e){"Enter"===e.key&&l(y,t)},error:p.length>0}),a.a.createElement(j.a,{style:{marginLeft:"10px"},error:!0},p))},H=n(37),P=n(212),W=n(208),K=n(103),B=n.n(K),z=n(102),Y=n.n(z);var J,X=function(e){var t=e.message,n=e.setMessage,r=e.handleSendMessage,s=e.typing,c=e.setTyping;return a.a.createElement(i.a,{item:!0,container:!0},a.a.createElement(i.a,{item:!0,xs:8,sm:10},a.a.createElement(I.a,{variant:"outlined",type:"text",style:{width:"100%",marginLeft:"5px"},value:t,onChange:function(e){n(e.target.value),""===e.target.value?c(!1):s||c(!0)},onKeyPress:function(e){"Enter"===e.key&&r()}})),a.a.createElement(i.a,{item:!0,xs:4,sm:2},a.a.createElement(p.a,{style:{height:"100%",width:"80%",marginLeft:"10px"},variant:"text",onClick:r},"Send")))};n(162);function V(){return a.a.createElement("div",{className:"typing"},a.a.createElement("div",{className:"typing__dot"}),a.a.createElement("div",{className:"typing__dot"}),a.a.createElement("div",{className:"typing__dot"}))}var $=function(e){var t=e.friends,n=e.setFriends,s=e.setRead,c=e.selectedIndex,o=e.setSelectedIndex,u=e.user,l=e.receiveMessage,m=e.messageConfirmation,E=e.scrollToTop,f=e.showFriends,g=e.backToFriends,b=e.scrollToBottom,h=e.someoneTyping,y=function(e){if("typing"===e.type)h(e);else if("addFriend"===e.type){var r=Object(H.a)(t);r.splice(0,0,e.friend),n(r)}else if("confirm"===e.type)m(e,s);else if("receive"===e.type){l(e,E);var a=document.getElementById("notification");a.muted=!1,a.play(),a.muted=!1}},O=Object(r.useState)(""),j=Object(v.a)(O,2),S=j[0],x=j[1],I=Object(r.useState)(!1),_=Object(v.a)(I,2),w=_[0],R=_[1],T=function(e){h(e)};Object(r.useEffect)((function(){return J=Y()("/"),console.log("on"),J.on(u.username,y),J.on("typing",T),function(){console.log("off"),J.off(u.username)}}),[u.username]),Object(r.useLayoutEffect)((function(){function e(){if(window.innerWidth>=600){if(k("block"),A.current){var e=w?240:185;A.current.style.setProperty("height","".concat(document.getElementById("root").clientHeight-e,"px"))}}else if(k(f?"none":"block"),A.current){var t=w?230:175;A.current.style.setProperty("height","".concat(document.getElementById("root").clientHeight-t,"px"))}}return window.addEventListener("resize",e),e(),function(){return window.removeEventListener("resize",e)}}),[f]);var N=Object(r.useState)("block"),L=Object(v.a)(N,2),C=L[0],k=L[1];Object(r.useEffect)((function(){window.innerWidth<600&&k(f?"none":"block")}),[f]),Object(r.useEffect)((function(){b()}),[c,t,b]),Object(r.useEffect)((function(){console.log(w),t.length>0&&J.emit("typing",{friend:t[c].username,typing:w})}),[w]);var A=Object(r.useRef)();return a.a.createElement(i.a,{item:!0,container:!0,direction:"column",xs:12,sm:8,lg:9,xl:10,style:{display:C}},a.a.createElement(i.a,{item:!0,container:!0,direction:"column",justify:"flex-end"},a.a.createElement(i.a,{item:!0,container:!0,alignItems:"center",style:{paddingLeft:"10px",paddingRight:"10px"}},a.a.createElement(i.a,{item:!0,sm:12,xs:10},a.a.createElement(d.a,{variant:"h4"},t.length>0&&t.length>c?t[c].username:"Messages")),a.a.createElement(i.a,{item:!0,xs:2},a.a.createElement(P.a,{smUp:!0},a.a.createElement(p.a,{size:"large",onClick:g},a.a.createElement(B.a,null))))),a.a.createElement(F.a,{id:"messages",ref:A,style:{overflowY:"scroll"}},t.length>0&&t.length>c?t[c].messages.map((function(e,t){return a.a.createElement(D.a,{style:{padding:0},key:t},e.pending?a.a.createElement(W.a,{size:25,variant:"indeterminate",style:{marginRight:"10px"}}):a.a.createElement("div",{style:{width:"35px",height:"25px"}}),a.a.createElement(U.a,null,"".concat(e.sender,": ").concat(e.message)))})):null),t.length>0&&t[c].typing?a.a.createElement(V,null):null),a.a.createElement(X,{friends:t,selectedIndex:c,setSelectedIndex:o,user:u,socket:J,setFriends:n,message:S,setMessage:x,typing:w,setTyping:R,handleSendMessage:function(){if(S){x(""),R(!1),J.emit("typing",{friend:t[c].username,typing:!1});var e={receiver:t[c].username,message:S,pending:!0},r=Object(H.a)(t),a=t.findIndex((function(t){return t.username===e.receiver}));r[a].messages.push({sender:u.username,message:S,pending:!0});var s=r[a];r.splice(a,1),r.splice(0,0,s),J.emit("message",e),o(0),n(r)}}}))};function q(){var e=document.getElementById("messages");e&&(e.scrollTop=e.scrollHeight-e.clientHeight)}function Q(){document.getElementById("friends").scroll({top:0,left:0,behavior:"smooth"})}var Z=Object(E.b)((function(e){return{user:e.auth.user,friends:e.chat.friends,selectedIndex:e.chat.selectedIndex,friendError:e.chat.friendError}}),(function(e){return{setFriends:function(t){e({type:"SET_FRIENDS",payload:{friends:t}})},setRead:function(t,n){e({type:"SET_READ",payload:{friends:t,index:n}})},setSelectedIndex:function(t){e({type:"SET_SELECTED_INDEX",payload:{selectedIndex:t}})},messageConfirmation:function(t){e({type:"MESSAGE_CONFIRMATION",payload:{msg:t}})},receiveMessage:function(t,n){e({type:"RECEIVE_MESSAGE",payload:{msg:t,scrollToTop:n}})},someoneTyping:function(t){e({type:"SOMEONE_TYPING",payload:t})},addFriend:function(t,n){e({type:"ADD_FRIEND",payload:{id:t,friends:n}})}}}))((function(e){var t=e.user,s=e.friends,c=e.setFriends,o=e.selectedIndex,u=e.setSelectedIndex,l=e.setRead,d=e.messageConfirmation,p=e.receiveMessage,m=e.someoneTyping,E=e.addFriend,f=e.friendError;Object(r.useLayoutEffect)((function(){function e(){g.current&&g.current.style.setProperty("height","".concat(document.getElementById("root").clientHeight-65,"px"))}return window.addEventListener("resize",e),e(),function(){return window.removeEventListener("resize",e)}}),[]);var g=Object(r.useRef)(),b=Object(r.useState)(!1),h=Object(v.a)(b,2),y=h[0],O=h[1];return a.a.createElement(i.a,{item:!0,container:!0,direction:"row",ref:g},a.a.createElement(G,{friends:s,setRead:l,selectedIndex:o,setSelectedIndex:u,scrollToBottom:q,showFriends:y,setShowFriends:O,addFriend:E,friendError:f}),a.a.createElement($,{user:t,friends:s,setFriends:c,setRead:l,selectedIndex:o,setSelectedIndex:u,messageConfirmation:d,receiveMessage:p,scrollToBottom:q,scrollToTop:Q,showFriends:y,backToFriends:function(){y||O(!0)},someoneTyping:m}),a.a.createElement("audio",{id:"notification",src:n(165),muted:!0}))}));var ee=function(){return Object(r.useEffect)((function(){document.title="Chat"}),[]),a.a.createElement(i.a,{container:!0,direction:"column",wrap:"nowrap",style:{height:"100vh"},alignItems:"stretch"},a.a.createElement(i.a,{item:!0},a.a.createElement(g,{title:"Chat"})),a.a.createElement(Z,null))},te=n(105),ne=function(e){var t=e.component,n=e.condition,r=e.redirectTo,s=Object(te.a)(e,["component","condition","redirectTo"]);return a.a.createElement(R.b,Object.assign({},s,{render:function(e){return n?a.a.createElement(t,Object.assign({},s,e)):a.a.createElement(R.a,{to:r})}}))},re=Object(m.a)({center:{textAlign:"center"},mgTop:{marginTop:"15px"},fullWidth:{width:"100%"}});var ae=Object(E.b)((function(e){return{inputFields:e.auth.inputFields,errorMessages:e.auth.errorMessages,userAvailable:e.auth.userAvailable}}),(function(e){return{userRegister:function(t){return e({type:"USER_REGISTER",payload:t})},checkUserName:function(t){e({type:"CHECK_USERNAME",payload:{username:t}})},setInputFields:function(t){return e({type:"SET_INPUT_FIELDS",payload:t})},resetIE:function(){return e({type:"RESET_IE"})}}}))((function(e){var t=e.checkUserName,n=e.userRegister,s=e.errorMessages,c=e.inputFields,o=e.setInputFields,u=e.resetIE,l=re(),m=Object(R.f)();Object(r.useEffect)((function(){var e=m.listen((function(e,t){u()}));return function(){e()}}),[m,u]);var E=function(){var e=Object(O.a)(h.a.mark((function e(t){return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n(Object(y.a)(Object(y.a)({},c),{},{history:m}));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return a.a.createElement(i.a,{item:!0,container:!0,direction:"column",className:l.mgTop,xs:10,md:4,spacing:2},a.a.createElement(d.a,{className:l.center,variant:"h2"},"Register"),a.a.createElement(i.a,{item:!0},a.a.createElement(w,{label:"User Name",type:"text",value:c.username,onChange:function(e){o(Object(y.a)(Object(y.a)({},c),{},{username:e.target.value})),t(e.target.value)},errorMessage:s.username})),a.a.createElement(i.a,{item:!0},a.a.createElement(w,{label:"Password",type:"Password",value:c.password,onChange:function(e){return o(Object(y.a)(Object(y.a)({},c),{},{password:e.target.value}))},errorMessage:s.password})),a.a.createElement(i.a,{item:!0},a.a.createElement(p.a,{className:l.fullWidth,size:"large",variant:"contained",color:"primary",onClick:E,type:"submit"},"Register")),a.a.createElement(p.a,{onClick:function(){return m.push("/login")}}," Login "))}));var se=function(){return Object(r.useEffect)((function(){document.title="Register"}),[]),a.a.createElement(i.a,{container:!0,direction:"row",justify:"center"},a.a.createElement(g,{title:"Register"}),a.a.createElement(i.a,{item:!0,xs:1,md:4}),a.a.createElement(ae,null),a.a.createElement(i.a,{item:!0,xs:1,md:4}))};var ce=Object(E.b)((function(e){return{loggedIn:e.auth.loggedIn,isLoading:e.auth.isLoading}}),(function(e){return{checkLogin:function(){return e({type:"CHECK_LOGIN"})}}}))((function(e){var t=e.checkLogin,n=e.loggedIn,s=e.isLoading;return Object(r.useEffect)((function(){t()}),[t]),s?"loading":a.a.createElement(o.a,null,a.a.createElement(ne,{path:"/",exact:!0,component:ee,condition:n,redirectTo:"/login"}),a.a.createElement(ne,{path:"/login",exact:!0,component:L,condition:!n,redirectTo:"/"}),a.a.createElement(ne,{path:"/register",exact:!0,component:se,condition:!n,redirectTo:"/"}),a.a.createElement(ne,{path:"/chat",exact:!0,component:ee,condition:n,redirectTo:"/login"}))}));Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var oe=n(26),ie={username:"",password:""},ue={username:"",password:"",other:""},le={loggedIn:!1,user:{},isLoading:!0,inputFields:ie,errorMessages:ue},de=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:le,t=arguments.length>1?arguments[1]:void 0;switch(console.log(t),t.type){case"CHECK_LOGIN_ASYNC":return Object(y.a)(Object(y.a)(Object(y.a)({},e),t.payload),{},{isLoading:!1});case"USER_LOGIN_SUCCESS":return Object(y.a)(Object(y.a)({},e),{},{isLoading:!1,loggedIn:!0,errorMessages:ue},t.payload);case"USER_LOGIN_FAILED":return Object(y.a)(Object(y.a)({},e),{},{isLoading:!1,loggedIn:!1,user:{}},t.payload);case"USER_REGISTER_SUCCESS":return Object(y.a)(Object(y.a)({},e),{},{errorMessages:ue,isLoading:!1,loggedIn:!1,user:{}});case"USER_REGISTER_FAILED":return Object(y.a)(Object(y.a)({},e),{},{isLoading:!1,loggedIn:!1,user:{}},t.payload);case"CHECK_USERNAME_SUCCESS":case"CHECK_USERNAME_FAILED":return Object(y.a)(Object(y.a)({},e),t.payload);case"SET_INPUT_FIELDS":return Object(y.a)(Object(y.a)({},e),{},{inputFields:t.payload});case"RESET_IE":return Object(y.a)(Object(y.a)({},e),{},{inputFields:ie,errorMessages:ue});case"USER_LOGOUT_ASYNC":return Object(y.a)(Object(y.a)({},e),{},{isLoading:!1,loggedIn:t.loggedIn,user:t.user,errorMessages:ue});case"SET_AUTH_LOADING":return Object(y.a)(Object(y.a)({},e),{},{isLoading:!0});default:return e}},pe={friends:[],selectedIndex:0,friendError:""},me=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:pe,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_FRIENDS":case"SET_SELECTED_INDEX":return Object(y.a)(Object(y.a)({},e),t.payload);case"MESSAGE_CONFIRMATION":for(var n=Object(H.a)(e.friends),r=t.payload.msg,a=n.findIndex((function(e){return e.username===r.receiver})),s=!1,c=n[a].messages.length-1;c>=0&&void 0===n[a].messages[c]._id;c--)if(n[a].messages[c].message===r.message){n[a].messages[c].pending=!1,s=!0;break}return s||n[a].messages.push(r),Object(y.a)(Object(y.a)({},e),{},{friends:n});case"RECEIVE_MESSAGE":var o=Object(H.a)(e.friends),i=e.selectedIndex,u=t.payload,l=u.msg,d=u.scrollToTop,p=o.findIndex((function(e){return e.username===l.sender}));if(-1!==p){o[p].messages.push(l),o[p].unRead=!0,p===i?(i=0,d()):p>i&&i++;var m=o[p];return o.splice(p,1),o.splice(0,0,m),Object(y.a)(Object(y.a)({},e),{},{friends:o,selectedIndex:i})}return o.splice(0,0,{username:l.sender,messages:[l],unRead:!0}),i++,Object(y.a)(Object(y.a)({},e),{},{friends:o,selectedIndex:i});case"SOMEONE_TYPING":var E=t.payload,f=E.typing,g=E.typer,b=Object(H.a)(e.friends),h=b.findIndex((function(e){return e.username===g}));return-1!==h&&(b[h].typing=f),Object(y.a)(Object(y.a)({},e),{},{friends:b});case"ADD_FRIEND_SUCCESS":return alert("".concat(t.payload.friends[0].username," added to friend list")),Object(y.a)(Object(y.a)(Object(y.a)({},e),t.payload),{},{friendError:""});case"ADD_FRIEND_FAILED":return Object(y.a)(Object(y.a)({},e),t.payload);default:return e}},Ee=Object(oe.c)({auth:de,chat:me}),fe=n(13),ge=h.a.mark(ve),be=h.a.mark(je),he=h.a.mark(Se),ye=h.a.mark(xe),Oe=h.a.mark(Ie);function ve(){var e,t;return h.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,Object(fe.b)({type:"SET_AUTH_LOADING"});case 2:return n.next=4,Object(fe.a)(Object(O.a)(h.a.mark((function t(){var n,r,a,s;return h.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,fetch("/auth/check/loggedin");case 3:return n=t.sent,t.next=6,n.json();case 6:return r=t.sent,a=r.loggedIn,s={username:r.user.username,id:r.user.id},e=r.user.friends,t.abrupt("return",{type:"CHECK_LOGIN_ASYNC",payload:{loggedIn:a,user:s}});case 13:t.prev=13,t.t0=t.catch(0),console.log(t.t0);case 16:return t.abrupt("return",{type:"CHECK_LOGIN_ASYNC"});case 17:case"end":return t.stop()}}),t,null,[[0,13]])}))));case 4:if(t=n.sent,!e){n.next=8;break}return n.next=8,Object(fe.b)({type:"SET_FRIENDS",payload:{friends:e}});case 8:return n.next=10,Object(fe.b)(t);case 10:case"end":return n.stop()}}),ge)}function je(e){var t,n,r,a,s,c;return h.a.wrap((function(o){for(;;)switch(o.prev=o.next){case 0:return t=e.payload,r=t.username,a=t.password,s=t.history,o.next=4,Object(fe.b)({type:"SET_AUTH_LOADING"});case 4:return o.next=6,Object(fe.a)(Object(O.a)(h.a.mark((function e(){var t,c,o,i;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch("/auth/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:r,password:a})});case 3:t=e.sent,e.t0=t.status,e.next=200===e.t0?7:400===e.t0?14:500===e.t0?20:21;break;case 7:return s.push("/chat"),e.next=10,t.json();case 10:return c=e.sent,n=c.friends,c={username:c.username,id:c.id},e.abrupt("return",{type:"USER_LOGIN_SUCCESS",payload:{user:c}});case 14:return e.next=16,t.json();case 16:return o=e.sent,i={},0===o.index?i.username=o.message:i.password=o.message,e.abrupt("return",{type:"USER_LOGIN_FAILED",payload:{errorMessages:i}});case 20:return e.abrupt("return",{type:"USER_LOGIN_FAILED",payload:{errorMessages:{other:"There is a problem with the Server"}}});case 21:return e.abrupt("return",{type:"USER_LOGIN_FAILED",payload:{errorMessages:{other:"Something went Wrong"}}});case 22:e.next=27;break;case 24:e.prev=24,e.t1=e.catch(0),console.log(e.t1);case 27:return e.abrupt("return",{type:"USER_LOGIN_FAILED",payload:{errorMessages:{other:"Something went Wrong"}}});case 28:case"end":return e.stop()}}),e,null,[[0,24]])}))));case 6:if(c=o.sent,!n){o.next=10;break}return o.next=10,Object(fe.b)({type:"SET_FRIENDS",payload:{friends:n}});case 10:return o.next=12,Object(fe.b)(c);case 12:case"end":return o.stop()}}),be)}function Se(e){var t,n;return h.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return t=e.payload,r.next=3,Object(fe.b)({type:"SET_AUTH_LOADING"});case 3:return r.next=5,Object(fe.a)(Object(O.a)(h.a.mark((function e(){var n,r,a,s,c,o,i;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.username,r=t.password,a=t.history,e.prev=1,e.next=4,fetch("/auth/register",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:n,password:r})});case 4:s=e.sent,e.t0=s.status,e.next=200===e.t0?8:400===e.t0?10:409===e.t0?16:500===e.t0?20:21;break;case 8:return a.push("/login"),e.abrupt("return",{type:"USER_REGISTER_SUCCESS"});case 10:return e.next=12,s.json();case 12:return c=e.sent,o={},0===c.index?o.username=c.message:o.password=c.message,e.abrupt("return",{type:"USER_REGISTER_FAILED",payload:{errorMessages:o}});case 16:return e.next=18,s.json();case 18:return i=e.sent,e.abrupt("return",{type:"USER_REGISTER_FAILED",payload:{errorMessages:{username:i}}});case 20:return e.abrupt("return",{type:"USER_REGISTER_FAILED",payload:{errorMessages:{other:"There is a problem with the Server"}}});case 21:return e.abrupt("return",{type:"USER_REGISTER_FAILED",payload:{errorMessages:{other:"Something went Wrong"}}});case 22:e.next=27;break;case 24:e.prev=24,e.t1=e.catch(1),console.log(e.t1);case 27:return e.abrupt("return",{type:"USER_REGISTER_FAILED",payload:{errorMessages:{other:"Something went Wrong"}}});case 28:case"end":return e.stop()}}),e,null,[[1,24]])}))));case 5:return n=r.sent,r.next=8,Object(fe.b)(n);case 8:case"end":return r.stop()}}),he)}function xe(){var e;return h.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(fe.b)({type:"USER_LOADING"});case 2:return t.next=4,Object(fe.a)(Object(O.a)(h.a.mark((function e(){var t;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t={user:{},errorMessage:""},e.prev=1,e.next=4,fetch("/auth/logout");case 4:200===e.sent.status&&(t.loggedIn=!1),e.next=12;break;case 8:e.prev=8,e.t0=e.catch(1),console.log("Error: ".concat(e.t0)),t.loggedIn=!1;case 12:return e.abrupt("return",t);case 13:case"end":return e.stop()}}),e,null,[[1,8]])}))));case 4:return e=t.sent,t.next=7,Object(fe.b)(Object(y.a)({type:"USER_LOGOUT_ASYNC"},e));case 7:case"end":return t.stop()}}),ye)}function Ie(e){var t,n;return h.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return t=e.payload,r.next=3,Object(fe.a)(Object(O.a)(h.a.mark((function e(){var n,r,a,s;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,n=t.username,e.next=4,fetch("/auth/check/username",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:n})});case 4:r=e.sent,e.t0=r.status,e.next=200===e.t0?8:500===e.t0?14:15;break;case 8:return e.next=10,r.json();case 10:return a=e.sent,s={},s=a?{username:"",other:""}:{username:"User ".concat(n," Already exists")},e.abrupt("return",{type:"CHECK_USERNAME_SUCCESS",payload:{errorMessages:s}});case 14:return e.abrupt("return",{type:"CHECK_USERNAME_FAILED",payload:{errorMessage:{other:"There is a problem with the Server"}}});case 15:return e.abrupt("return",{type:"CHECK_USERNAME_FAILED",payload:{errorMessages:{other:"Something went Wrong"}}});case 16:e.next=21;break;case 18:e.prev=18,e.t1=e.catch(0),console.log(e.t1);case 21:return e.abrupt("return",{type:"CHECK_USERNAME_FAILED",payload:{errorMessages:{other:"Something went Wrong"}}});case 22:case"end":return e.stop()}}),e,null,[[0,18]])}))));case 3:return n=r.sent,r.next=6,Object(fe.b)(n);case 6:case"end":return r.stop()}}),Oe)}var _e=h.a.mark(Re),we=h.a.mark(Te);function Re(e){var t,n,r,a,s;return h.a.wrap((function(c){for(;;)switch(c.prev=c.next){case 0:return t=e.payload,n=t.friends,r=t.index,a=Object(H.a)(n),c.next=5,Object(fe.a)((function(){try{fetch("/chat/messageRead",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({friendName:n[r].username})})}catch(e){console.log(e)}return a[r].unRead=!1,{type:"SET_FRIENDS",payload:{friends:a}}}));case 5:return s=c.sent,c.next=8,Object(fe.b)(s);case 8:case"end":return c.stop()}}),_e)}function Te(e){var t,n,r,a,s;return h.a.wrap((function(c){for(;;)switch(c.prev=c.next){case 0:return t=e.payload,n=t.id,r=t.friends,a=Object(H.a)(r),c.next=5,Object(fe.a)(Object(O.a)(h.a.mark((function e(){var t,r,s,c;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch("/chat/addFriend",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:n})});case 3:if(200!==(t=e.sent).status){e.next=12;break}return e.next=7,t.json();case 7:return r=e.sent,a.splice(0,0,r),e.abrupt("return",{type:"ADD_FRIEND_SUCCESS",payload:{friends:a}});case 12:if(400!==t.status){e.next=20;break}return e.next=15,t.json();case 15:return s=e.sent,c=s.error,e.abrupt("return",{type:"ADD_FRIEND_FAILED",payload:{friendError:c}});case 20:return e.abrupt("return",{type:"ADD_FRIEND_FAILED",payload:{friendError:"Something went wrong"}});case 21:e.next=27;break;case 23:return e.prev=23,e.t0=e.catch(0),console.log(e.t0),e.abrupt("return",{type:"ADD_FRIEND_FAILED",payload:{friendError:"Something went wrong"}});case 27:case"end":return e.stop()}}),e,null,[[0,23]])}))));case 5:return s=c.sent,c.next=8,Object(fe.b)(s);case 8:case"end":return c.stop()}}),we)}var Ne=h.a.mark(Le);function Le(){return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(fe.c)("CHECK_LOGIN",ve);case 2:return e.next=4,Object(fe.c)("USER_REGISTER",Se);case 4:return e.next=6,Object(fe.c)("USER_LOGIN",je);case 6:return e.next=8,Object(fe.c)("USER_LOGOUT",xe);case 8:return e.next=10,Object(fe.c)("CHECK_USERNAME",Ie);case 10:return e.next=12,Object(fe.c)("SET_READ",Re);case 12:return e.next=14,Object(fe.c)("ADD_FRIEND",Te);case 14:case"end":return e.stop()}}),Ne)}var Ce,Fe,De=n(104),ke=Object(De.a)();try{Ce=Object(oe.d)(Object(oe.a)(ke),window.__REDUX_DEVTOOLS_EXTENSION__&&window.__REDUX_DEVTOOLS_EXTENSION__()),Fe=Object(oe.e)(Ee,Ce)}catch(Ae){Fe=Object(oe.e)(Ee,Object(oe.a)(ke)),console.log(Ae)}ke.run(Le),c.a.render(a.a.createElement(a.a.StrictMode,null,a.a.createElement(E.a,{store:Fe},a.a.createElement(ce,null))),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[118,1,2]]]);
//# sourceMappingURL=main.b61e2890.chunk.js.map