{"version":3,"sources":["assets/stairs.mp3","Components/Header.js","Components/MUInput.js","Components/LoginForm.js","pages/Login.js","Components/FriendsTab.js","Components/SendMessageTab.js","Components/MessagesTab.js","Components/Typing.js","Components/MainChat.js","pages/Chat.js","Components/ProtectedRoute.js","Components/RegisterForm.js","pages/Register.js","App.js","serviceWorker.js","states/reducers/authReducer.js","states/reducers/chatReducer.js","states/reducers/rootReducer.js","states/sagas/authSaga.js","states/sagas/chatSaga.js","states/sagas/sagas.js","index.js"],"names":["module","exports","useStyles","makeStyles","theme","root","flexGrow","title","connect","state","loggedIn","auth","user","dispatch","logOut","type","classes","AppBar","position","Toolbar","Typography","variant","className","Grid","container","justify","alignItems","spacing","item","id","username","Button","color","onClick","to","style","textDecoration","fullWidth","width","MUInput","label","value","errorMessage","onChange","TextField","helperText","error","length","center","textAlign","mgTop","marginTop","inputFields","errorMessages","userLogin","payload","setInputFields","resetIE","history","useHistory","useEffect","unlisten","listen","location","action","useState","keep","setKeep","handleLogin","e","a","direction","xs","md","target","password","FormHelperText","other","FormControlLabel","control","Checkbox","checked","name","size","push","Login","document","Friends","friends","setRead","selectedIndex","setSelectedIndex","showFriends","setShowFriends","addFriend","friendError","useLayoutEffect","updateSize","ref","current","setProperty","getElementById","clientHeight","window","innerWidth","setDisplay","addEventListener","removeEventListener","unRead","display","friendId","setFriendId","useRef","Box","component","sm","lg","xl","List","overflowY","map","index","ListItem","key","button","selected","handleContactChange","ListItemAvatar","Avatar","alt","src","ListItemText","primary","Badge","marginLeft","marginRight","onKeyPress","SendMessageTab","socket","message","setMessage","handleSendMessage","typing","setTyping","height","Typing","MessagesTab","setFriends","receiveMessage","messageConfirmation","scrollToTop","backToFriends","scrollToBottom","someoneTyping","handleSocketEvent","msg","temp","splice","friend","notification","muted","play","handleTypingEvent","io","console","log","on","off","extraHeight","emit","paddingLeft","paddingRight","Hidden","smUp","messages","padding","pending","CircularProgress","sender","receiver","foundIndex","findIndex","div","scrollTop","scrollHeight","scroll","top","left","behavior","chat","require","Chat","wrap","ProtectedRoute","Component","condition","redirectTo","rest","render","props","userAvailable","userRegister","checkUserName","handleRegister","Register","isLoading","checkLogin","path","exact","Boolean","hostname","match","emptyInputs","emptyError","initialState","loginReducer","chatReducer","friendIndex","messageFound","i","undefined","_id","typer","alert","rootReducer","combineReducers","authReducer","userLogout","put","call","fetch","res","json","data","newAction","method","headers","body","JSON","stringify","status","info","result","friendName","mySaga","takeLatest","enhanser","store","sagaMiddleware","createSagaMiddleware","compose","applyMiddleware","__REDUX_DEVTOOLS_EXTENSION__","createStore","err","run","ReactDOM","StrictMode","navigator","serviceWorker","ready","then","registration","unregister","catch"],"mappings":"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","file":"static/js/main.8e1ddc0f.chunk.js","sourcesContent":["module.exports = __webpack_public_path__ + \"static/media/stairs.ac905963.mp3\";","import React from \"react\";\r\nimport { AppBar, Toolbar, Typography, Button, Grid } from \"@material-ui/core\";\r\nimport { Link } from \"react-router-dom\";\r\nimport { makeStyles } from \"@material-ui/core/styles\";\r\nimport { connect } from \"react-redux\";\r\n\r\nconst useStyles = makeStyles((theme) => ({\r\n  root: {\r\n    flexGrow: 1,\r\n  },\r\n  title: {\r\n    flexGrow: 1,\r\n  },\r\n}));\r\n\r\nfunction Header({ loggedIn, logOut, user }) {\r\n  const classes = useStyles();\r\n  return (\r\n    <AppBar position=\"static\">\r\n      <Toolbar>\r\n        <Typography variant=\"h6\" className={classes.title}>\r\n          Chat\r\n        </Typography>\r\n        {loggedIn ? (\r\n          <Grid container justify=\"flex-end\" alignItems=\"center\" spacing={2}>\r\n            <Grid item>\r\n              <Typography variant=\"subtitle1\" className={classes.title}>\r\n                {`id: ${user.id}`}\r\n              </Typography>\r\n            </Grid>\r\n            <Grid item>\r\n              <Typography variant=\"h6\" className={classes.title}>\r\n                {user.username}\r\n              </Typography>\r\n            </Grid>\r\n            <Grid item>\r\n              <Button color=\"inherit\" onClick={logOut}>\r\n                Logout\r\n              </Button>\r\n            </Grid>\r\n          </Grid>\r\n        ) : (\r\n          <Button color=\"inherit\">\r\n            <Link\r\n              to=\"/login\"\r\n              style={{ textDecoration: \"none\", color: \"white\" }}\r\n            >\r\n              Login\r\n            </Link>\r\n          </Button>\r\n        )}\r\n      </Toolbar>\r\n    </AppBar>\r\n  );\r\n}\r\n\r\nconst mapStateToProps = (state) => {\r\n  return {\r\n    loggedIn: state.auth.loggedIn,\r\n    user: state.auth.user,\r\n  };\r\n};\r\n\r\nconst mapDispatchToProps = (dispatch) => {\r\n  return {\r\n    logOut: () => dispatch({ type: \"USER_LOGOUT\" }),\r\n  };\r\n};\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(Header);\r\n","import React from \"react\";\r\nimport { TextField } from \"@material-ui/core\";\r\nimport { makeStyles } from \"@material-ui/core/styles\";\r\n\r\nconst useStyles = makeStyles({\r\n  fullWidth: {\r\n    width: \"100%\",\r\n  },\r\n});\r\n\r\nexport default function MUInput({\r\n  label,\r\n  value,\r\n  type,\r\n  errorMessage,\r\n  onChange,\r\n}) {\r\n  const classes = useStyles();\r\n  return (\r\n    <TextField\r\n      variant=\"outlined\"\r\n      type={type}\r\n      className={classes.fullWidth}\r\n      label={label}\r\n      value={value}\r\n      helperText={errorMessage}\r\n      error={errorMessage ? errorMessage.length !== 0 : false}\r\n      onChange={onChange}\r\n    />\r\n  );\r\n}\r\n","import React, { useState, useEffect } from \"react\";\r\nimport {\r\n  Typography,\r\n  Button,\r\n  Grid,\r\n  Checkbox,\r\n  FormControlLabel,\r\n  FormHelperText,\r\n} from \"@material-ui/core\";\r\nimport MUInput from \"../Components/MUInput\";\r\nimport { useHistory } from \"react-router-dom\";\r\nimport { connect } from \"react-redux\";\r\n\r\nimport { makeStyles } from \"@material-ui/core/styles\";\r\n\r\nconst useStyles = makeStyles({\r\n  center: {\r\n    textAlign: \"center\",\r\n  },\r\n  mgTop: {\r\n    marginTop: \"15px\",\r\n  },\r\n  fullWidth: {\r\n    width: \"100%\",\r\n  },\r\n});\r\n\r\nfunction LoginForm({\r\n  userLogin,\r\n  errorMessages,\r\n  inputFields,\r\n  setInputFields,\r\n  resetIE,\r\n}) {\r\n  const classes = useStyles();\r\n  const history = useHistory();\r\n\r\n  useEffect(() => {\r\n    const unlisten = history.listen((location, action) => {\r\n      resetIE();\r\n    });\r\n    return () => {\r\n      unlisten();\r\n    };\r\n  }, [history, resetIE]);\r\n\r\n  const [keep, setKeep] = useState(true);\r\n\r\n  const handleLogin = async (e) => {\r\n    userLogin({ ...inputFields, keep, history });\r\n  };\r\n\r\n  return (\r\n    <Grid\r\n      item\r\n      container\r\n      spacing={2}\r\n      direction=\"column\"\r\n      className={classes.mgTop}\r\n      xs={10}\r\n      md={6}\r\n    >\r\n      <Typography className={classes.center} variant=\"h2\">\r\n        Login\r\n      </Typography>\r\n      <Grid item>\r\n        <MUInput\r\n          label=\"User Name\"\r\n          type=\"text\"\r\n          value={inputFields.username}\r\n          onChange={(e) => {\r\n            setInputFields({ ...inputFields, username: e.target.value });\r\n          }}\r\n          errorMessage={errorMessages.username}\r\n        />\r\n      </Grid>\r\n      <Grid item>\r\n        <MUInput\r\n          label=\"Password\"\r\n          type=\"Password\"\r\n          value={inputFields.password}\r\n          onChange={(e) => {\r\n            setInputFields({ ...inputFields, password: e.target.value });\r\n          }}\r\n          errorMessage={errorMessages.password}\r\n        />\r\n      </Grid>\r\n      <FormHelperText error>{errorMessages.other}</FormHelperText>\r\n      <Grid item>\r\n        <FormControlLabel\r\n          control={\r\n            <Checkbox\r\n              checked={keep}\r\n              onChange={() => setKeep(!keep)}\r\n              name=\"checkedB\"\r\n              color=\"primary\"\r\n            />\r\n          }\r\n          label=\"Keep Me Logged In\"\r\n        />\r\n      </Grid>\r\n      <Grid item>\r\n        <Button\r\n          className={classes.fullWidth}\r\n          size=\"large\"\r\n          variant=\"contained\"\r\n          color=\"primary\"\r\n          onClick={handleLogin}\r\n        >\r\n          Login\r\n        </Button>\r\n      </Grid>\r\n      <Button onClick={() => history.push(\"/register\")}> Register </Button>\r\n    </Grid>\r\n  );\r\n}\r\n\r\nconst mapStateToProps = (state) => {\r\n  return {\r\n    inputFields: state.auth.inputFields,\r\n    errorMessages: state.auth.errorMessages,\r\n  };\r\n};\r\n\r\nconst mapDispatchToProps = (dispatch) => {\r\n  return {\r\n    userLogin: (payload) =>\r\n      dispatch({\r\n        type: \"USER_LOGIN\",\r\n        payload,\r\n      }),\r\n    setInputFields: (payload) =>\r\n      dispatch({ type: \"SET_INPUT_FIELDS\", payload }),\r\n    resetIE: () => dispatch({ type: \"RESET_IE\" }),\r\n  };\r\n};\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(LoginForm);\r\n","import React, { useEffect } from \"react\";\r\nimport { Grid } from \"@material-ui/core\";\r\n\r\nimport Header from \"../Components/Header\";\r\nimport LoginForm from \"../Components/LoginForm\";\r\n\r\nfunction Login() {\r\n  useEffect(() => {\r\n    document.title = \"Login\";\r\n  }, []);\r\n\r\n  return (\r\n    <Grid container direction=\"row\" justify=\"center\">\r\n      <Header />\r\n      <Grid item xs={1} md={3} />\r\n      <LoginForm />\r\n      <Grid item xs={1} md={3} />\r\n    </Grid>\r\n  );\r\n}\r\n\r\nexport default Login;\r\n","import React, { useState, useRef, useEffect, useLayoutEffect } from \"react\";\r\nimport {\r\n  Grid,\r\n  List,\r\n  ListItem,\r\n  ListItemAvatar,\r\n  Avatar,\r\n  Typography,\r\n  Box,\r\n  ListItemText,\r\n  Badge,\r\n  TextField,\r\n  FormHelperText,\r\n} from \"@material-ui/core\";\r\n\r\nfunction Friends({\r\n  friends,\r\n  setRead,\r\n  selectedIndex,\r\n  setSelectedIndex,\r\n  showFriends,\r\n  setShowFriends,\r\n  addFriend,\r\n  friendError,\r\n}) {\r\n  useLayoutEffect(() => {\r\n    function updateSize() {\r\n      if (ref.current) {\r\n        const extraHeight = 210;\r\n        ref.current.style.setProperty(\r\n          \"height\",\r\n          `${document.getElementById(\"root\").clientHeight - extraHeight}px`\r\n        );\r\n      }\r\n\r\n      if (window.innerWidth >= 600) setDisplay(\"block\");\r\n      else setDisplay(showFriends ? \"block\" : \"none\");\r\n    }\r\n    window.addEventListener(\"resize\", updateSize);\r\n    updateSize();\r\n    return () => window.removeEventListener(\"resize\", updateSize);\r\n  }, [showFriends]);\r\n\r\n  useEffect(() => {\r\n    // if the messages aren't read\r\n    if (friends.length > 0 && friends[selectedIndex].unRead)\r\n      setRead(friends, selectedIndex);\r\n  }, [selectedIndex, friends, setRead]);\r\n\r\n  const handleContactChange = (index) => {\r\n    setSelectedIndex(index);\r\n\r\n    if (showFriends) setShowFriends(false);\r\n  };\r\n  // display stuff\r\n  const [display, setDisplay] = useState(\"block\");\r\n  useEffect(() => {\r\n    // making use of the size change\r\n    if (window.innerWidth < 600) {\r\n      setDisplay(showFriends ? \"block\" : \"none\");\r\n    }\r\n  }, [showFriends]);\r\n\r\n  const handleAddFriend = () => {\r\n    addFriend(friendId, friends);\r\n  };\r\n\r\n  const [friendId, setFriendId] = useState(\"\");\r\n  const ref = useRef();\r\n\r\n  return (\r\n    <Box component={Grid} item xs={12} sm={4} lg={3} xl={2} style={{ display }}>\r\n      <Typography variant=\"h4\">Friends</Typography>\r\n      <List\r\n        ref={ref}\r\n        id=\"friends\"\r\n        style={{\r\n          overflowY: \"scroll\",\r\n        }}\r\n      >\r\n        {friends.map((item, index) => {\r\n          return (\r\n            <ListItem\r\n              key={index}\r\n              button\r\n              selected={selectedIndex === index}\r\n              onClick={() => handleContactChange(index)}\r\n            >\r\n              <ListItemAvatar>\r\n                <Avatar\r\n                  alt={item.username}\r\n                  src={`/static/images/avatar/${index + 1}.jpg`}\r\n                />\r\n              </ListItemAvatar>\r\n              <ListItemText primary={item.username} />\r\n              {item.unRead ? <Badge color=\"secondary\" variant=\"dot\" /> : null}\r\n            </ListItem>\r\n          );\r\n        })}\r\n      </List>\r\n      <TextField\r\n        variant=\"outlined\"\r\n        label=\"Add Friend\"\r\n        style={{\r\n          width: \"95%\",\r\n          marginTop: \"10px\",\r\n          marginLeft: \"5px\",\r\n          marginRight: \"5px\",\r\n        }}\r\n        value={friendId}\r\n        onChange={(e) => setFriendId(e.target.value)}\r\n        onKeyPress={(e) => {\r\n          if (e.key === \"Enter\") handleAddFriend();\r\n        }}\r\n        error={friendError.length > 0}\r\n      />\r\n      <FormHelperText\r\n        style={{\r\n          marginLeft: \"10px\",\r\n        }}\r\n        error={true}\r\n      >\r\n        {friendError}\r\n      </FormHelperText>\r\n    </Box>\r\n  );\r\n}\r\n\r\nexport default Friends;\r\n","import React from \"react\";\r\nimport { Grid, Button, TextField } from \"@material-ui/core\";\r\n\r\nfunction SendMessageTab({\r\n  message,\r\n  setMessage,\r\n  handleSendMessage,\r\n  typing,\r\n  setTyping,\r\n}) {\r\n  const handleTextChange = (e) => {\r\n    setMessage(e.target.value);\r\n    if (e.target.value === \"\") {\r\n      setTyping(false);\r\n    } else if (!typing) {\r\n      setTyping(true);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <Grid item container>\r\n      <Grid item xs={8} sm={10}>\r\n        <TextField\r\n          variant=\"outlined\"\r\n          type=\"text\"\r\n          style={{ width: \"100%\", marginLeft: \"5px\" }}\r\n          value={message}\r\n          onChange={handleTextChange}\r\n          onKeyPress={(e) => {\r\n            if (e.key === \"Enter\") handleSendMessage();\r\n          }}\r\n        />\r\n      </Grid>\r\n      <Grid item xs={4} sm={2}>\r\n        <Button\r\n          style={{ height: \"100%\", width: \"80%\", marginLeft: \"10px\" }}\r\n          variant=\"text\"\r\n          onClick={handleSendMessage}\r\n        >\r\n          Send\r\n        </Button>\r\n      </Grid>\r\n    </Grid>\r\n  );\r\n}\r\n\r\nexport default SendMessageTab;\r\n","import React, { useState, useEffect, useLayoutEffect, useRef } from \"react\";\r\nimport {\r\n  Grid,\r\n  Hidden,\r\n  List,\r\n  Typography,\r\n  ListItemText,\r\n  CircularProgress,\r\n  ListItem,\r\n  Button,\r\n} from \"@material-ui/core\";\r\nimport ArrowBackIcon from \"@material-ui/icons/ArrowBack\";\r\n\r\nimport io from \"socket.io-client\";\r\nimport SendMessageTab from \"./SendMessageTab\";\r\n\r\nimport Typing from \"./Typing\";\r\n\r\nlet socket;\r\n\r\nfunction MessagesTab({\r\n  friends,\r\n  setFriends,\r\n  setRead,\r\n  selectedIndex,\r\n  setSelectedIndex,\r\n  user,\r\n  receiveMessage,\r\n  messageConfirmation,\r\n  scrollToTop,\r\n  showFriends,\r\n  backToFriends,\r\n  scrollToBottom,\r\n  someoneTyping,\r\n}) {\r\n  const handleSocketEvent = (msg) => {\r\n    // if someone typing\r\n    if (msg.type === \"typing\") {\r\n      someoneTyping(msg);\r\n    }\r\n    // if someone add us as a friend\r\n    else if (msg.type === \"addFriend\") {\r\n      const temp = [...friends];\r\n      temp.splice(0, 0, msg.friend);\r\n      setFriends(temp);\r\n    }\r\n    // if the message confirmation\r\n    else if (msg.type === \"confirm\") {\r\n      messageConfirmation(msg, setRead);\r\n    }\r\n    // if we received a message from another user\r\n    else if (msg.type === \"receive\") {\r\n      receiveMessage(msg, scrollToTop);\r\n\r\n      // playing receive message sound\r\n      const notification = document.getElementById(\"notification\");\r\n      notification.muted = false;\r\n      notification.play();\r\n      notification.muted = false;\r\n    }\r\n  };\r\n\r\n  const [message, setMessage] = useState(\"\");\r\n  const [typing, setTyping] = useState(false);\r\n\r\n  const handleSendMessage = () => {\r\n    if (!message) return;\r\n    setMessage(\"\");\r\n    setTyping(false);\r\n    socket.emit(\"typing\", {\r\n      friend: friends[selectedIndex].username,\r\n      typing: false,\r\n    });\r\n\r\n    const receiver = {\r\n      receiver: friends[selectedIndex].username,\r\n      message,\r\n      pending: true,\r\n    };\r\n\r\n    const temp = [...friends];\r\n    const foundIndex = friends.findIndex(\r\n      (friend) => friend.username === receiver.receiver\r\n    );\r\n\r\n    temp[foundIndex].messages.push({\r\n      sender: user.username,\r\n      message,\r\n      pending: true,\r\n    });\r\n\r\n    // getting friend from the array\r\n    const friend = temp[foundIndex];\r\n    //delteting the friend from the array\r\n    temp.splice(foundIndex, 1);\r\n    // pushing it again at the beggining\r\n    temp.splice(0, 0, friend);\r\n\r\n    socket.emit(\"message\", receiver);\r\n\r\n    setSelectedIndex(0);\r\n    setFriends(temp);\r\n  };\r\n\r\n  const handleTypingEvent = (msg) => {\r\n    someoneTyping(msg);\r\n  };\r\n\r\n  useEffect(() => {\r\n    socket = io(\"/\");\r\n\r\n    // received a message\r\n    console.log(\"on\");\r\n    socket.on(user.username, handleSocketEvent);\r\n    socket.on(\"typing\", handleTypingEvent);\r\n\r\n    return () => {\r\n      console.log(\"off\");\r\n      socket.off(user.username);\r\n    };\r\n  }, [user.username]);\r\n\r\n  useLayoutEffect(() => {\r\n    function updateSize() {\r\n      if (window.innerWidth >= 600) {\r\n        setDisplay(\"block\");\r\n        if (ref.current) {\r\n          const extraHeight = typing ? 240 : 185;\r\n          ref.current.style.setProperty(\r\n            \"height\",\r\n            `${document.getElementById(\"root\").clientHeight - extraHeight}px`\r\n          );\r\n        }\r\n      } else {\r\n        setDisplay(showFriends ? \"none\" : \"block\");\r\n        if (ref.current) {\r\n          const extraHeight = typing ? 230 : 175;\r\n          ref.current.style.setProperty(\r\n            \"height\",\r\n            `${document.getElementById(\"root\").clientHeight - extraHeight}px`\r\n          );\r\n        }\r\n      }\r\n    }\r\n    window.addEventListener(\"resize\", updateSize);\r\n    updateSize();\r\n    return () => window.removeEventListener(\"resize\", updateSize);\r\n  }, [showFriends]);\r\n\r\n  // display stuff\r\n  const [display, setDisplay] = useState(\"block\");\r\n  useEffect(() => {\r\n    // making use of the size change\r\n    if (window.innerWidth < 600) {\r\n      setDisplay(showFriends ? \"none\" : \"block\");\r\n    }\r\n  }, [showFriends]);\r\n\r\n  useEffect(() => {\r\n    scrollToBottom();\r\n  }, [selectedIndex, friends, scrollToBottom]);\r\n\r\n  useEffect(() => {\r\n    console.log(typing);\r\n    socket.emit(\"typing\", {\r\n      friend: friends[selectedIndex].username,\r\n      typing,\r\n    });\r\n  }, [typing]);\r\n\r\n  const ref = useRef();\r\n\r\n  return (\r\n    <Grid\r\n      item\r\n      container\r\n      direction=\"column\"\r\n      xs={12}\r\n      sm={8}\r\n      lg={9}\r\n      xl={10}\r\n      style={{ display }}\r\n    >\r\n      <Grid item container direction=\"column\" justify=\"flex-end\">\r\n        <Grid\r\n          item\r\n          container\r\n          alignItems=\"center\"\r\n          style={{ paddingLeft: \"10px\", paddingRight: \"10px\" }}\r\n        >\r\n          <Grid item sm={12} xs={10}>\r\n            <Typography variant=\"h4\">\r\n              {friends.length > 0 && friends.length > selectedIndex\r\n                ? friends[selectedIndex].username\r\n                : \"Messages\"}\r\n            </Typography>\r\n          </Grid>\r\n          <Grid item xs={2}>\r\n            <Hidden smUp>\r\n              <Button size=\"large\" onClick={backToFriends}>\r\n                <ArrowBackIcon />\r\n              </Button>\r\n            </Hidden>\r\n          </Grid>\r\n        </Grid>\r\n        <List\r\n          id=\"messages\"\r\n          ref={ref}\r\n          style={{\r\n            overflowY: \"scroll\",\r\n          }}\r\n        >\r\n          {friends.length > 0 && friends.length > selectedIndex\r\n            ? friends[selectedIndex].messages.map((message, index) => (\r\n                <ListItem style={{ padding: 0 }} key={index}>\r\n                  {message.pending ? (\r\n                    <CircularProgress\r\n                      size={25}\r\n                      variant=\"indeterminate\"\r\n                      style={{\r\n                        marginRight: \"10px\",\r\n                      }}\r\n                    />\r\n                  ) : (\r\n                    <div style={{ width: \"35px\", height: \"25px\" }} />\r\n                  )}\r\n                  <ListItemText>{`${message.sender}: ${message.message}`}</ListItemText>\r\n                </ListItem>\r\n              ))\r\n            : null}\r\n        </List>\r\n        {friends.length > 0 && friends[selectedIndex].typing ? (\r\n          <Typing />\r\n        ) : null}\r\n      </Grid>\r\n      <SendMessageTab\r\n        friends={friends}\r\n        selectedIndex={selectedIndex}\r\n        setSelectedIndex={setSelectedIndex}\r\n        user={user}\r\n        socket={socket}\r\n        setFriends={setFriends}\r\n        message={message}\r\n        setMessage={setMessage}\r\n        typing={typing}\r\n        setTyping={setTyping}\r\n        handleSendMessage={handleSendMessage}\r\n      />\r\n    </Grid>\r\n  );\r\n}\r\n\r\nexport default MessagesTab;\r\n","import React from \"react\";\r\nimport \"./styles/typing.css\";\r\n\r\nexport default function Typing() {\r\n  return (\r\n    <div className=\"typing\">\r\n      <div className=\"typing__dot\"></div>\r\n      <div className=\"typing__dot\"></div>\r\n      <div className=\"typing__dot\"></div>\r\n    </div>\r\n  );\r\n}\r\n","import React, { useState, useLayoutEffect, useRef } from \"react\";\r\nimport { Grid } from \"@material-ui/core\";\r\nimport Friends from \"./FriendsTab\";\r\n\r\nimport { connect } from \"react-redux\";\r\nimport MessagesTab from \"./MessagesTab\";\r\n\r\n// scroll messages to bottoms\r\nfunction scrollToBottom() {\r\n  let div = document.getElementById(\"messages\");\r\n  if (div) div.scrollTop = div.scrollHeight - div.clientHeight;\r\n}\r\n\r\n// scroll friends to top\r\nfunction scrollToTop() {\r\n  let friends = document.getElementById(\"friends\");\r\n  friends.scroll({\r\n    top: 0,\r\n    left: 0,\r\n    behavior: \"smooth\",\r\n  });\r\n}\r\n\r\nfunction MainChat({\r\n  user,\r\n  friends,\r\n  setFriends,\r\n  selectedIndex,\r\n  setSelectedIndex,\r\n  setRead,\r\n  messageConfirmation,\r\n  receiveMessage,\r\n  someoneTyping,\r\n  addFriend,\r\n  friendError,\r\n}) {\r\n  useLayoutEffect(() => {\r\n    function updateSize() {\r\n      if (ref.current)\r\n        ref.current.style.setProperty(\r\n          \"height\",\r\n          `${document.getElementById(\"root\").clientHeight - 65}px`\r\n        );\r\n    }\r\n    window.addEventListener(\"resize\", updateSize);\r\n    updateSize();\r\n    return () => window.removeEventListener(\"resize\", updateSize);\r\n  }, []);\r\n\r\n  const ref = useRef();\r\n\r\n  const [showFriends, setShowFriends] = useState(false);\r\n\r\n  const backToFriends = () => {\r\n    if (!showFriends) setShowFriends(true);\r\n  };\r\n\r\n  return (\r\n    <Grid item container direction=\"row\" ref={ref}>\r\n      <Friends\r\n        friends={friends}\r\n        setRead={setRead}\r\n        selectedIndex={selectedIndex}\r\n        setSelectedIndex={setSelectedIndex}\r\n        scrollToBottom={scrollToBottom}\r\n        showFriends={showFriends}\r\n        setShowFriends={setShowFriends}\r\n        addFriend={addFriend}\r\n        friendError={friendError}\r\n      />\r\n      <MessagesTab\r\n        user={user}\r\n        friends={friends}\r\n        setFriends={setFriends}\r\n        setRead={setRead}\r\n        selectedIndex={selectedIndex}\r\n        setSelectedIndex={setSelectedIndex}\r\n        messageConfirmation={messageConfirmation}\r\n        receiveMessage={receiveMessage}\r\n        scrollToBottom={scrollToBottom}\r\n        scrollToTop={scrollToTop}\r\n        showFriends={showFriends}\r\n        backToFriends={backToFriends}\r\n        someoneTyping={someoneTyping}\r\n      />\r\n      <audio id=\"notification\" src={require(\"../assets/stairs.mp3\")} muted />\r\n    </Grid>\r\n  );\r\n}\r\n\r\nconst mapStateToProps = (state) => {\r\n  return {\r\n    user: state.auth.user,\r\n    friends: state.chat.friends,\r\n    selectedIndex: state.chat.selectedIndex,\r\n    friendError: state.chat.friendError,\r\n  };\r\n};\r\n\r\nconst mapDispatchToProps = (dispatch) => {\r\n  return {\r\n    setFriends: (friends) => {\r\n      dispatch({ type: \"SET_FRIENDS\", payload: { friends } });\r\n    },\r\n    setRead: (friends, index) => {\r\n      dispatch({ type: \"SET_READ\", payload: { friends, index } });\r\n    },\r\n    setSelectedIndex: (selectedIndex) => {\r\n      dispatch({ type: \"SET_SELECTED_INDEX\", payload: { selectedIndex } });\r\n    },\r\n    messageConfirmation: (msg) => {\r\n      dispatch({ type: \"MESSAGE_CONFIRMATION\", payload: { msg } });\r\n    },\r\n    receiveMessage: (msg, scrollToTop) => {\r\n      dispatch({ type: \"RECEIVE_MESSAGE\", payload: { msg, scrollToTop } });\r\n    },\r\n    someoneTyping: (msg) => {\r\n      dispatch({ type: \"SOMEONE_TYPING\", payload: msg });\r\n    },\r\n    addFriend: (id, friends) => {\r\n      dispatch({ type: \"ADD_FRIEND\", payload: { id, friends } });\r\n    },\r\n  };\r\n};\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(MainChat);\r\n","import React, { useEffect } from \"react\";\r\nimport { Grid } from \"@material-ui/core\";\r\nimport Header from \"../Components/Header\";\r\n\r\nimport MainChat from \"../Components/MainChat\";\r\n\r\nfunction Chat() {\r\n  useEffect(() => {\r\n    document.title = \"Chat\";\r\n  }, []);\r\n\r\n  return (\r\n    <Grid\r\n      container\r\n      direction=\"column\"\r\n      wrap=\"nowrap\"\r\n      style={{ height: \"100vh\" }}\r\n      alignItems=\"stretch\"\r\n    >\r\n      <Grid item>\r\n        <Header title=\"Chat\" />\r\n      </Grid>\r\n      <MainChat />\r\n    </Grid>\r\n  );\r\n}\r\n\r\nexport default Chat;\r\n","import React from \"react\";\r\nimport { Route, Redirect } from \"react-router-dom\";\r\n\r\nconst ProtectedRoute = ({\r\n  component: Component,\r\n  condition,\r\n  redirectTo,\r\n  ...rest\r\n}) => {\r\n  return (\r\n    <Route\r\n      {...rest}\r\n      render={(props) => {\r\n        if (condition) return <Component {...rest} {...props} />;\r\n        else return <Redirect to={redirectTo} />;\r\n      }}\r\n    />\r\n  );\r\n};\r\n\r\nexport default ProtectedRoute;\r\n","import React, { useEffect } from \"react\";\r\nimport { Typography, Button, Grid } from \"@material-ui/core\";\r\nimport MUInput from \"../Components/MUInput\";\r\nimport { useHistory } from \"react-router-dom\";\r\nimport { connect } from \"react-redux\";\r\n\r\nimport { makeStyles } from \"@material-ui/core/styles\";\r\n\r\nconst useStyles = makeStyles({\r\n  center: {\r\n    textAlign: \"center\",\r\n  },\r\n  mgTop: {\r\n    marginTop: \"15px\",\r\n  },\r\n  fullWidth: {\r\n    width: \"100%\",\r\n  },\r\n});\r\n\r\nfunction RegisterForm({\r\n  checkUserName,\r\n  userRegister,\r\n  errorMessages,\r\n  inputFields,\r\n  setInputFields,\r\n  resetIE,\r\n}) {\r\n  const classes = useStyles();\r\n\r\n  const history = useHistory();\r\n\r\n  useEffect(() => {\r\n    const unlisten = history.listen((location, action) => {\r\n      resetIE();\r\n    });\r\n    return () => {\r\n      unlisten();\r\n    };\r\n  }, [history, resetIE]);\r\n\r\n  const handleRegister = async (e) => {\r\n    userRegister({ ...inputFields, history });\r\n  };\r\n\r\n  const handleUserNameChange = (e) => {\r\n    setInputFields({ ...inputFields, username: e.target.value });\r\n    checkUserName(e.target.value);\r\n  };\r\n\r\n  return (\r\n    <Grid\r\n      item\r\n      container\r\n      direction=\"column\"\r\n      className={classes.mgTop}\r\n      xs={10}\r\n      md={4}\r\n      spacing={2}\r\n    >\r\n      <Typography className={classes.center} variant=\"h2\">\r\n        Register\r\n      </Typography>\r\n      <Grid item>\r\n        <MUInput\r\n          label=\"User Name\"\r\n          type=\"text\"\r\n          value={inputFields.username}\r\n          onChange={handleUserNameChange}\r\n          errorMessage={errorMessages.username}\r\n        />\r\n      </Grid>\r\n      <Grid item>\r\n        <MUInput\r\n          label=\"Password\"\r\n          type=\"Password\"\r\n          value={inputFields.password}\r\n          onChange={(e) =>\r\n            setInputFields({ ...inputFields, password: e.target.value })\r\n          }\r\n          errorMessage={errorMessages.password}\r\n        />\r\n      </Grid>\r\n      <Grid item>\r\n        <Button\r\n          className={classes.fullWidth}\r\n          size=\"large\"\r\n          variant=\"contained\"\r\n          color=\"primary\"\r\n          onClick={handleRegister}\r\n          type=\"submit\"\r\n        >\r\n          Register\r\n        </Button>\r\n      </Grid>\r\n      <Button onClick={() => history.push(\"/login\")}> Login </Button>\r\n    </Grid>\r\n  );\r\n}\r\n\r\nconst mapStateToProps = (state) => {\r\n  return {\r\n    inputFields: state.auth.inputFields,\r\n    errorMessages: state.auth.errorMessages,\r\n    userAvailable: state.auth.userAvailable,\r\n  };\r\n};\r\n\r\nconst mapDispatchToProps = (dispatch) => {\r\n  return {\r\n    userRegister: (payload) =>\r\n      dispatch({\r\n        type: \"USER_REGISTER\",\r\n        payload,\r\n      }),\r\n    checkUserName: (username) => {\r\n      dispatch({\r\n        type: \"CHECK_USERNAME\",\r\n        payload: { username },\r\n      });\r\n    },\r\n    setInputFields: (payload) =>\r\n      dispatch({ type: \"SET_INPUT_FIELDS\", payload }),\r\n    resetIE: () => dispatch({ type: \"RESET_IE\" }),\r\n  };\r\n};\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(RegisterForm);\r\n","import React, { useEffect } from \"react\";\r\nimport { Grid } from \"@material-ui/core\";\r\n\r\nimport Header from \"../Components/Header\";\r\nimport RegisterForm from \"../Components/RegisterForm\";\r\n\r\nfunction Register() {\r\n  useEffect(() => {\r\n    document.title = \"Register\";\r\n  }, []);\r\n\r\n  return (\r\n    <Grid container direction=\"row\" justify=\"center\">\r\n      <Header title=\"Register\" />\r\n      <Grid item xs={1} md={4} />\r\n      <RegisterForm />\r\n      <Grid item xs={1} md={4} />\r\n    </Grid>\r\n  );\r\n}\r\n\r\nexport default Register;\r\n","import React, { useEffect } from \"react\";\r\nimport { BrowserRouter as Router } from \"react-router-dom\";\r\nimport Login from \"./pages/Login\";\r\nimport Chat from \"./pages/Chat\";\r\nimport ProtectedRoute from \"./Components/ProtectedRoute\";\r\nimport { connect } from \"react-redux\";\r\nimport Register from \"./pages/Register\";\r\n\r\nfunction App({ checkLogin, loggedIn, isLoading }) {\r\n  useEffect(() => {\r\n    checkLogin();\r\n  }, [checkLogin]);\r\n\r\n  if (isLoading) return \"loading\";\r\n\r\n  return (\r\n    <Router>\r\n      <ProtectedRoute\r\n        path=\"/\"\r\n        exact\r\n        component={Chat}\r\n        condition={loggedIn}\r\n        redirectTo=\"/login\"\r\n      />\r\n      <ProtectedRoute\r\n        path=\"/login\"\r\n        exact\r\n        component={Login}\r\n        condition={!loggedIn}\r\n        redirectTo=\"/\"\r\n      />\r\n      <ProtectedRoute\r\n        path=\"/register\"\r\n        exact\r\n        component={Register}\r\n        condition={!loggedIn}\r\n        redirectTo=\"/\"\r\n      />\r\n      <ProtectedRoute\r\n        path=\"/chat\"\r\n        exact\r\n        component={Chat}\r\n        condition={loggedIn}\r\n        redirectTo=\"/login\"\r\n      />\r\n    </Router>\r\n  );\r\n}\r\n\r\nconst mapStateToProps = (state) => {\r\n  return {\r\n    loggedIn: state.auth.loggedIn,\r\n    isLoading: state.auth.isLoading,\r\n  };\r\n};\r\nconst mapDispatchToProps = (dispatch) => {\r\n  return {\r\n    checkLogin: () => dispatch({ type: \"CHECK_LOGIN\" }),\r\n  };\r\n};\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(App);\r\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.0/8 are considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl, {\n    headers: { 'Service-Worker': 'script' },\n  })\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready\n      .then(registration => {\n        registration.unregister();\n      })\n      .catch(error => {\n        console.error(error.message);\n      });\n  }\n}\n","// to save time\r\nconst emptyInputs = { username: \"\", password: \"\" };\r\nconst emptyError = { username: \"\", password: \"\", other: \"\" };\r\n\r\nconst initialState = {\r\n  loggedIn: false,\r\n  user: {},\r\n  isLoading: true,\r\n  inputFields: emptyInputs,\r\n  errorMessages: emptyError,\r\n};\r\n\r\nconst loginReducer = (state = initialState, action) => {\r\n  console.log(action);\r\n  switch (action.type) {\r\n    case \"CHECK_LOGIN_ASYNC\":\r\n      return {\r\n        ...state,\r\n        ...action.payload,\r\n        isLoading: false,\r\n      };\r\n    case \"USER_LOGIN_SUCCESS\":\r\n      return {\r\n        ...state,\r\n        isLoading: false,\r\n        loggedIn: true,\r\n        errorMessages: emptyError,\r\n        ...action.payload,\r\n      };\r\n    case \"USER_LOGIN_FAILED\":\r\n      return {\r\n        ...state,\r\n        isLoading: false,\r\n        loggedIn: false,\r\n        user: {},\r\n        ...action.payload,\r\n      };\r\n    case \"USER_REGISTER_SUCCESS\":\r\n      return {\r\n        ...state,\r\n        errorMessages: emptyError,\r\n        isLoading: false,\r\n        loggedIn: false,\r\n        user: {},\r\n      };\r\n    case \"USER_REGISTER_FAILED\":\r\n      return {\r\n        ...state,\r\n        isLoading: false,\r\n        loggedIn: false,\r\n        user: {},\r\n        ...action.payload,\r\n      };\r\n    case \"CHECK_USERNAME_SUCCESS\":\r\n      return {\r\n        ...state,\r\n        ...action.payload,\r\n      };\r\n    case \"CHECK_USERNAME_FAILED\":\r\n      return {\r\n        ...state,\r\n        ...action.payload,\r\n      };\r\n    case \"SET_INPUT_FIELDS\":\r\n      return {\r\n        ...state,\r\n        inputFields: action.payload,\r\n      };\r\n    case \"RESET_IE\": {\r\n      return {\r\n        ...state,\r\n        inputFields: emptyInputs,\r\n        errorMessages: emptyError,\r\n      };\r\n    }\r\n\r\n    case \"USER_LOGOUT_ASYNC\":\r\n      return {\r\n        ...state,\r\n        isLoading: false,\r\n        loggedIn: action.loggedIn,\r\n        user: action.user,\r\n        errorMessages: emptyError,\r\n      };\r\n    case \"SET_AUTH_LOADING\":\r\n      return { ...state, isLoading: true };\r\n    default:\r\n      return state;\r\n  }\r\n};\r\n\r\nexport default loginReducer;\r\n","const initialState = {\r\n  friends: [],\r\n  selectedIndex: 0,\r\n  friendError: \"\",\r\n};\r\n\r\nconst chatReducer = (state = initialState, action) => {\r\n  switch (action.type) {\r\n    case \"SET_FRIENDS\":\r\n      return {\r\n        ...state,\r\n        ...action.payload,\r\n      };\r\n    case \"SET_SELECTED_INDEX\": {\r\n      return {\r\n        ...state,\r\n        ...action.payload,\r\n      };\r\n    }\r\n    case \"MESSAGE_CONFIRMATION\": {\r\n      const temp = [...state.friends];\r\n      const { msg } = action.payload;\r\n\r\n      const friendIndex = temp.findIndex(\r\n        (friend) => friend.username === msg.receiver\r\n      );\r\n\r\n      let messageFound = false;\r\n\r\n      for (let i = temp[friendIndex].messages.length - 1; i >= 0; i--) {\r\n        // this condition means that we arrived at the messages  from the server\r\n        if (temp[friendIndex].messages[i]._id !== undefined) break;\r\n\r\n        if (temp[friendIndex].messages[i].message === msg.message) {\r\n          temp[friendIndex].messages[i].pending = false;\r\n          messageFound = true;\r\n          break;\r\n        }\r\n      }\r\n\r\n      if (!messageFound) temp[friendIndex].messages.push(msg);\r\n\r\n      return {\r\n        ...state,\r\n        friends: temp,\r\n      };\r\n    }\r\n    case \"RECEIVE_MESSAGE\": {\r\n      const temp = [...state.friends];\r\n      let selectedIndex = state.selectedIndex;\r\n\r\n      const { msg, scrollToTop } = action.payload;\r\n\r\n      const foundIndex = temp.findIndex(\r\n        (friend) => friend.username === msg.sender\r\n      );\r\n\r\n      // sender in friends\r\n      if (foundIndex !== -1) {\r\n        temp[foundIndex].messages.push(msg);\r\n\r\n        temp[foundIndex].unRead = true;\r\n        // if we are in the senders chat we make him on top\r\n        if (foundIndex === selectedIndex) {\r\n          selectedIndex = 0;\r\n          scrollToTop();\r\n        }\r\n        // else we make it unRead\r\n        else {\r\n          if (foundIndex > selectedIndex) selectedIndex++;\r\n        }\r\n\r\n        // getting the sender friend from the array\r\n        const friend = temp[foundIndex];\r\n        //delteting the friend from the array\r\n        temp.splice(foundIndex, 1);\r\n        // pushing it again at the beggining\r\n        temp.splice(0, 0, friend);\r\n\r\n        return {\r\n          ...state,\r\n          friends: temp,\r\n          selectedIndex,\r\n        };\r\n      }\r\n      // sender isn't in friends (so we add it)\r\n      else {\r\n        temp.splice(0, 0, {\r\n          username: msg.sender,\r\n          messages: [msg],\r\n          unRead: true,\r\n        });\r\n        selectedIndex++;\r\n      }\r\n\r\n      return {\r\n        ...state,\r\n        friends: temp,\r\n        selectedIndex,\r\n      };\r\n    }\r\n    case \"SOMEONE_TYPING\": {\r\n      const { typing, typer } = action.payload;\r\n      const temp = [...state.friends];\r\n\r\n      const friendIndex = temp.findIndex((friend) => friend.username === typer);\r\n\r\n      if (friendIndex !== -1) {\r\n        temp[friendIndex].typing = typing;\r\n      }\r\n\r\n      return {\r\n        ...state,\r\n        friends: temp,\r\n      };\r\n    }\r\n    case \"ADD_FRIEND_SUCCESS\": {\r\n      alert(`${action.payload.friends[0].username} added to friend list`);\r\n      return {\r\n        ...state,\r\n        ...action.payload,\r\n        friendError: \"\",\r\n      };\r\n    }\r\n    case \"ADD_FRIEND_FAILED\": {\r\n      return {\r\n        ...state,\r\n        ...action.payload,\r\n      };\r\n    }\r\n    default:\r\n      return state;\r\n  }\r\n};\r\n\r\nexport default chatReducer;\r\n","import { combineReducers } from \"redux\";\r\nimport authReducer from \"./authReducer\";\r\nimport chatReducer from \"./chatReducer\";\r\n\r\nconst rootReducer = combineReducers({ auth: authReducer, chat: chatReducer });\r\n\r\nexport default rootReducer;\r\n","import { put, call } from \"redux-saga/effects\";\r\n\r\n// check if the user is logged in\r\nexport function* checkLogin() {\r\n  yield put({ type: \"SET_AUTH_LOADING\" });\r\n\r\n  let friends;\r\n\r\n  const newAction = yield call(async () => {\r\n    try {\r\n      const res = await fetch(\"/auth/check/loggedin\");\r\n\r\n      const data = await res.json();\r\n\r\n      const loggedIn = data.loggedIn;\r\n      const user = { username: data.user.username, id: data.user.id };\r\n      friends = data.user.friends;\r\n\r\n      return {\r\n        type: \"CHECK_LOGIN_ASYNC\",\r\n        payload: { loggedIn, user },\r\n      };\r\n    } catch (error) {\r\n      console.log(error);\r\n    }\r\n\r\n    return { type: \"CHECK_LOGIN_ASYNC\" };\r\n  });\r\n\r\n  if (friends) yield put({ type: \"SET_FRIENDS\", payload: { friends } });\r\n\r\n  yield put(newAction);\r\n}\r\n\r\n// login the user\r\nexport function* userLogin({ payload }) {\r\n  let friends;\r\n  const { username, password, history } = payload;\r\n\r\n  yield put({ type: \"SET_AUTH_LOADING\" });\r\n\r\n  const newAction = yield call(async () => {\r\n    try {\r\n      const res = await fetch(\"/auth/login\", {\r\n        method: \"POST\",\r\n        headers: {\r\n          \"Content-Type\": \"application/json\",\r\n        },\r\n        body: JSON.stringify({ username, password }),\r\n      });\r\n\r\n      switch (res.status) {\r\n        case 200: {\r\n          history.push(\"/chat\");\r\n          let user = await res.json();\r\n          friends = user.friends;\r\n          user = { username: user.username, id: user.id };\r\n\r\n          return { type: \"USER_LOGIN_SUCCESS\", payload: { user } };\r\n        }\r\n        case 400: {\r\n          const info = await res.json();\r\n          let errorMessages = {};\r\n          if (info.index === 0) errorMessages.username = info.message;\r\n          else errorMessages.password = info.message;\r\n\r\n          return {\r\n            type: \"USER_LOGIN_FAILED\",\r\n            payload: { errorMessages },\r\n          };\r\n        }\r\n        case 500: {\r\n          return {\r\n            type: \"USER_LOGIN_FAILED\",\r\n            payload: {\r\n              errorMessages: {\r\n                other: \"There is a problem with the Server\",\r\n              },\r\n            },\r\n          };\r\n        }\r\n        default: {\r\n          return {\r\n            type: \"USER_LOGIN_FAILED\",\r\n            payload: {\r\n              errorMessages: {\r\n                other: \"Something went Wrong\",\r\n              },\r\n            },\r\n          };\r\n        }\r\n      }\r\n    } catch (err) {\r\n      console.log(err);\r\n    }\r\n\r\n    return {\r\n      type: \"USER_LOGIN_FAILED\",\r\n      payload: {\r\n        errorMessages: {\r\n          other: \"Something went Wrong\",\r\n        },\r\n      },\r\n    };\r\n  });\r\n\r\n  if (friends) yield put({ type: \"SET_FRIENDS\", payload: { friends } });\r\n\r\n  yield put(newAction);\r\n}\r\n\r\n// register the user\r\nexport function* userRegister({ payload }) {\r\n  yield put({ type: \"SET_AUTH_LOADING\" });\r\n\r\n  const newAction = yield call(async () => {\r\n    const { username, password, history } = payload;\r\n\r\n    try {\r\n      const res = await fetch(\"/auth/register\", {\r\n        method: \"POST\",\r\n        headers: {\r\n          \"Content-Type\": \"application/json\",\r\n        },\r\n        body: JSON.stringify({ username, password }),\r\n      });\r\n\r\n      switch (res.status) {\r\n        case 200: {\r\n          history.push(\"/login\");\r\n          return {\r\n            type: \"USER_REGISTER_SUCCESS\",\r\n          };\r\n        }\r\n        case 400: {\r\n          const data = await res.json();\r\n          let errorMessages = {};\r\n          if (data.index === 0) errorMessages.username = data.message;\r\n          else errorMessages.password = data.message;\r\n          return {\r\n            type: \"USER_REGISTER_FAILED\",\r\n            payload: { errorMessages },\r\n          };\r\n        }\r\n        case 409: {\r\n          const errorMessage = await res.json();\r\n          return {\r\n            type: \"USER_REGISTER_FAILED\",\r\n            payload: { errorMessages: { username: errorMessage } },\r\n          };\r\n        }\r\n        case 500: {\r\n          return {\r\n            type: \"USER_REGISTER_FAILED\",\r\n            payload: {\r\n              errorMessages: { other: \"There is a problem with the Server\" },\r\n            },\r\n          };\r\n        }\r\n        default: {\r\n          return {\r\n            type: \"USER_REGISTER_FAILED\",\r\n            payload: {\r\n              errorMessages: { other: \"Something went Wrong\" },\r\n            },\r\n          };\r\n        }\r\n      }\r\n    } catch (error) {\r\n      console.log(error);\r\n    }\r\n\r\n    return {\r\n      type: \"USER_REGISTER_FAILED\",\r\n      payload: {\r\n        errorMessages: { other: \"Something went Wrong\" },\r\n      },\r\n    };\r\n  });\r\n\r\n  yield put(newAction);\r\n}\r\n\r\n// logout the user\r\nexport function* userLogout() {\r\n  yield put({ type: \"USER_LOADING\" });\r\n  const result = yield call(async () => {\r\n    const data = { user: {}, errorMessage: \"\" };\r\n    try {\r\n      const res = await fetch(\"/auth/logout\");\r\n\r\n      if (res.status === 200) {\r\n        data.loggedIn = false;\r\n      }\r\n    } catch (err) {\r\n      console.log(`Error: ${err}`);\r\n      data.loggedIn = false;\r\n    }\r\n    return data;\r\n  });\r\n\r\n  yield put({ type: \"USER_LOGOUT_ASYNC\", ...result });\r\n}\r\n\r\n// check if the username is available\r\nexport function* checkUserName({ payload }) {\r\n  const newAction = yield call(async () => {\r\n    try {\r\n      const { username } = payload;\r\n\r\n      const res = await fetch(\"/auth/check/username\", {\r\n        method: \"POST\",\r\n        headers: {\r\n          \"Content-Type\": \"application/json\",\r\n        },\r\n        body: JSON.stringify({ username }),\r\n      });\r\n\r\n      switch (res.status) {\r\n        case 200: {\r\n          const userAvailable = await res.json();\r\n          let errorMessages = {};\r\n          if (!userAvailable)\r\n            errorMessages = { username: `User ${username} Already exists` };\r\n          else errorMessages = { username: \"\", other: \"\" };\r\n          return {\r\n            type: \"CHECK_USERNAME_SUCCESS\",\r\n            payload: {\r\n              errorMessages,\r\n            },\r\n          };\r\n        }\r\n        case 500: {\r\n          return {\r\n            type: \"CHECK_USERNAME_FAILED\",\r\n            payload: {\r\n              errorMessage: { other: \"There is a problem with the Server\" },\r\n            },\r\n          };\r\n        }\r\n        default: {\r\n          return {\r\n            type: \"CHECK_USERNAME_FAILED\",\r\n            payload: { errorMessages: { other: \"Something went Wrong\" } },\r\n          };\r\n        }\r\n      }\r\n    } catch (error) {\r\n      console.log(error);\r\n    }\r\n\r\n    return {\r\n      type: \"CHECK_USERNAME_FAILED\",\r\n      payload: { errorMessages: { other: \"Something went Wrong\" } },\r\n    };\r\n  });\r\n\r\n  yield put(newAction);\r\n}\r\n","import { put, call } from \"redux-saga/effects\";\r\n\r\nexport function* setRead({ payload }) {\r\n  let { friends, index } = payload;\r\n  const temp = [...friends];\r\n\r\n  const newAction = yield call(() => {\r\n    try {\r\n      // trying a methode send and not check if it is success (like facebook)\r\n      fetch(\"/chat/messageRead\", {\r\n        method: \"POST\",\r\n        headers: {\r\n          \"Content-Type\": \"application/json\",\r\n        },\r\n        body: JSON.stringify({ friendName: friends[index].username }),\r\n      });\r\n    } catch (error) {\r\n      console.log(error);\r\n    }\r\n    // just changing it locally\r\n    temp[index].unRead = false;\r\n    return { type: \"SET_FRIENDS\", payload: { friends: temp } };\r\n  });\r\n\r\n  yield put(newAction);\r\n}\r\n\r\nexport function* addFriend({ payload }) {\r\n  let { id, friends } = payload;\r\n  const temp = [...friends];\r\n\r\n  const newAction = yield call(async () => {\r\n    try {\r\n      // trying a methode send and not check if it is success (like facebook)\r\n      const res = await fetch(\"/chat/addFriend\", {\r\n        method: \"POST\",\r\n        headers: {\r\n          \"Content-Type\": \"application/json\",\r\n        },\r\n        body: JSON.stringify({ id }),\r\n      });\r\n\r\n      if (res.status === 200) {\r\n        const friend = await res.json();\r\n        temp.splice(0, 0, friend);\r\n\r\n        return { type: \"ADD_FRIEND_SUCCESS\", payload: { friends: temp } };\r\n      } else if (res.status === 400) {\r\n        const { error } = await res.json();\r\n        return {\r\n          type: \"ADD_FRIEND_FAILED\",\r\n          payload: { friendError: error },\r\n        };\r\n      } else {\r\n        return {\r\n          type: \"ADD_FRIEND_FAILED\",\r\n          payload: { friendError: \"Something went wrong\" },\r\n        };\r\n      }\r\n    } catch (error) {\r\n      console.log(error);\r\n      return {\r\n        type: \"ADD_FRIEND_FAILED\",\r\n        payload: { friendError: \"Something went wrong\" },\r\n      };\r\n    }\r\n  });\r\n\r\n  yield put(newAction);\r\n}\r\n","import { takeLatest } from \"redux-saga/effects\";\r\nimport {\r\n  checkLogin,\r\n  userLogin,\r\n  userLogout,\r\n  userRegister,\r\n  checkUserName,\r\n} from \"./authSaga\";\r\nimport { setRead, addFriend } from \"./chatSaga\";\r\n\r\nexport default function* mySaga() {\r\n  // auth\r\n  yield takeLatest(\"CHECK_LOGIN\", checkLogin);\r\n  yield takeLatest(\"USER_REGISTER\", userRegister);\r\n  yield takeLatest(\"USER_LOGIN\", userLogin);\r\n  yield takeLatest(\"USER_LOGOUT\", userLogout);\r\n  yield takeLatest(\"CHECK_USERNAME\", checkUserName);\r\n\r\n  // chat\r\n  yield takeLatest(\"SET_READ\", setRead);\r\n  yield takeLatest(\"ADD_FRIEND\", addFriend);\r\n}\r\n","import React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport \"./index.css\";\nimport App from \"./App\";\nimport * as serviceWorker from \"./serviceWorker\";\n\nimport { Provider } from \"react-redux\";\nimport { createStore, applyMiddleware, compose } from \"redux\";\nimport rootReducer from \"./states/reducers/rootReducer\";\nimport mySaga from \"./states/sagas/sagas\";\nimport createSagaMiddleware from \"redux-saga\";\n\nconst sagaMiddleware = createSagaMiddleware();\n\nlet enhanser, store;\n\ntry {\n  enhanser = compose(\n    applyMiddleware(sagaMiddleware),\n    window.__REDUX_DEVTOOLS_EXTENSION__ && window.__REDUX_DEVTOOLS_EXTENSION__()\n  );\n  store = createStore(rootReducer, enhanser);\n} catch (err) {\n  store = createStore(rootReducer, applyMiddleware(sagaMiddleware));\n  console.log(err);\n}\n\nsagaMiddleware.run(mySaga);\n\nReactDOM.render(\n  <React.StrictMode>\n    <Provider store={store}>\n      <App />\n    </Provider>\n  </React.StrictMode>,\n  document.getElementById(\"root\")\n);\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n"],"sourceRoot":""}